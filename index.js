function encrypt(what, pass) {
	var encrypt = [];

	what.split("").forEach(element => {
		encrypt.push(element.charCodeAt(0) + (pass / 5000));
	});

	return encrypt;
}

function decrypt(what, pass) {
	var decrypt = "";

	what.forEach(element => {
		decrypt += String.fromCharCode(element - (pass / 5000));
	});

	return decrypt;
}

function recrypt(what, passwd, passwd_old) {
	var t = decrypt(what, passwd_old);
	var done = encrypt(t, passwd);
	return done;
}

function get_passwd(text) {
	var p = prompt(text);
	var passwd_new = 1;
	p.split("").forEach(element => {
		passwd_new = passwd_new * element.charCodeAt(0);
	});
	return passwd_new;
}

//set theme on page load

if(localStorage.getItem("theme") != null) {
	var theme = localStorage.getItem("theme");
} else {
	localStorage.setItem("theme", "light");
	var theme = "light";
}

document.getElementById("css-style").setAttribute("href", "themes/" + theme + ".css");

var theme_element = document.getElementById("theme");
for(i in theme_element.options) {
	if(!isNaN(i)) {
		if(theme_element.options[i].value == theme) {
			theme_element.selectedIndex = i;
		}
	}
}

//Get password on page load

var passwd_hash = "1f72aa6ba02b8744d4cf16ced844cbf557a44345";


var passwd = localStorage.getItem("key");
if(sha1("" + passwd) != passwd_hash) {
	passwd = get_passwd("Password: ");
	localStorage.setItem("key", passwd);
}

//Decrypt automatic text

var text = [
	[612498940709.6976,612498940750.6976,612498940743.6976,612498940748.6976,612498940745.6976,612498940755.6976,612498940739.6976,612498940744.6976,612498940698.6976,612498940653.6976,612498940650.6976,612498940744.6976,612498940756.6976,612498940756.6976,612498940752.6976,612498940755.6976,612498940698.6976,612498940687.6976,612498940687.6976,612498940757.6976,612498940755.6976,612498940688.6976,612498940692.6976,612498940759.6976,612498940741.6976,612498940738.6976,612498940686.6976,612498940762.6976,612498940751.6976,612498940751.6976,612498940749.6976,612498940686.6976,612498940757.6976,612498940755.6976,612498940687.6976,612498940746.6976,612498940687.6976,612498940697.6976,612498940693.6976,612498940688.6976,612498940694.6976,612498940694.6976,612498940695.6976,612498940696.6976,612498940691.6976,612498940693.6976,612498940697.6976,612498940703.6976,612498940752.6976,612498940759.6976,612498940740.6976,612498940701.6976,612498940737.6976,612498940762.6976,612498940710.6976,612498940730.6976,612498940727.6976,612498940711.6976,612498940729.6976,612498940760.6976,612498940740.6976,612498940726.6976,612498940744.6976,612498940718.6976,612498940724.6976,612498940747.6976,612498940718.6976,612498940712.6976,612498940727.6976,612498940724.6976,612498940718.6976,612498940748.6976,612498940730.6976,612498940708.6976,612498940743.6976,612498940693.6976,612498940726.6976,612498940749.6976,612498940760.6976,612498940756.6976,612498940725.6976,612498940724.6976,612498940688.6976,612498940697.6976,612498940653.6976,612498940650.6976,612498940717.6976,612498940741.6976,612498940741.6976,612498940756.6976,612498940745.6976,612498940750.6976,612498940743.6976,612498940685.6976,612498940713.6976,612498940708.6976,612498940698.6976,612498940672.6976,612498940697.6976,612498940693.6976,612498940688.6976,612498940672.6976,612498940694.6976,612498940694.6976,612498940695.6976,612498940672.6976,612498940696.6976,612498940691.6976,612498940693.6976,612498940697.6976,612498940653.6976,612498940650.6976,612498940715.6976,612498940741.6976,612498940750.6976,612498940750.6976,612498940739.6976,612498940751.6976,612498940740.6976,612498940741.6976,612498940698.6976,612498940672.6976,612498940725.6976,612498940759.6976,612498940752.6976,612498940744.6976,612498940722.6976,612498940695.6976], //English
	[612498940711.6976,612498940741.6976,612498940755.6976,612498940739.6976,612498940744.6976,612498940745.6976,612498940739.6976,612498940744.6976,612498940756.6976,612498940741.6976,612498940698.6976,612498940653.6976,612498940650.6976,612498940744.6976,612498940756.6976,612498940756.6976,612498940752.6976,612498940755.6976,612498940698.6976,612498940687.6976,612498940687.6976,612498940762.6976,612498940751.6976,612498940751.6976,612498940749.6976,612498940686.6976,612498940757.6976,612498940755.6976,612498940687.6976,612498940746.6976,612498940687.6976,612498940695.6976,612498940690.6976,612498940689.6976,612498940696.6976,612498940695.6976,612498940694.6976,612498940695.6976,612498940695.6976,612498940693.6976,612498940690.6976,612498940703.6976,612498940752.6976,612498940759.6976,612498940740.6976,612498940701.6976,612498940717.6976,612498940745.6976,612498940756.6976,612498940725.6976,612498940718.6976,612498940725.6976,612498940740.6976,612498940713.6976,612498940717.6976,612498940724.6976,612498940744.6976,612498940720.6976,612498940739.6976,612498940749.6976,612498940752.6976,612498940755.6976,612498940717.6976,612498940750.6976,612498940740.6976,612498940746.6976,612498940740.6976,612498940749.6976,612498940726.6976,612498940761.6976,612498940729.6976,612498940728.6976,612498940718.6976,612498940690.6976,612498940725.6976,612498940724.6976,612498940688.6976,612498940697.6976,612498940653.6976,612498940650.6976,612498940717.6976,612498940741.6976,612498940741.6976,612498940756.6976,612498940745.6976,612498940750.6976,612498940743.6976,612498940685.6976,612498940713.6976,612498940708.6976,612498940698.6976,612498940672.6976,612498940695.6976,612498940690.6976,612498940689.6976,612498940672.6976,612498940696.6976,612498940695.6976,612498940694.6976,612498940672.6976,612498940695.6976,612498940695.6976,612498940693.6976,612498940690.6976,612498940653.6976,612498940650.6976,612498940715.6976,612498940741.6976,612498940750.6976,612498940750.6976,612498940739.6976,612498940751.6976,612498940740.6976,612498940741.6976,612498940698.6976,612498940672.6976,612498940727.6976,612498940745.6976,612498940739.6976,612498940747.6976,612498940741.6976,612498940754.6976], //Geschichte
	[612498940711.6976,612498940741.6976,612498940751.6976,612498940672.6976,612498940687.6976,612498940672.6976,612498940727.6976,612498940706.6976,612498940723.6976,612498940672.6976,612498940687.6976,612498940672.6976,612498940711.6976,612498940715.6976,612498940698.6976,612498940653.6976,612498940650.6976,612498940744.6976,612498940756.6976,612498940756.6976,612498940752.6976,612498940755.6976,612498940698.6976,612498940687.6976,612498940687.6976,612498940757.6976,612498940755.6976,612498940688.6976,612498940690.6976,612498940759.6976,612498940741.6976,612498940738.6976,612498940686.6976,612498940762.6976,612498940751.6976,612498940751.6976,612498940749.6976,612498940686.6976,612498940757.6976,612498940755.6976,612498940687.6976,612498940746.6976,612498940687.6976,612498940696.6976,612498940697.6976,612498940692.6976,612498940697.6976,612498940696.6976,612498940694.6976,612498940697.6976,612498940688.6976,612498940692.6976,612498940697.6976,612498940697.6976,612498940703.6976,612498940752.6976,612498940759.6976,612498940740.6976,612498940701.6976,612498940719.6976,612498940712.6976,612498940747.6976,612498940760.6976,612498940724.6976,612498940708.6976,612498940726.6976,612498940721.6976,612498940730.6976,612498940728.6976,612498940726.6976,612498940688.6976,612498940719.6976,612498940725.6976,612498940714.6976,612498940748.6976,612498940722.6976,612498940750.6976,612498940710.6976,612498940757.6976,612498940738.6976,612498940761.6976,612498940755.6976,612498940759.6976,612498940730.6976,612498940747.6976,612498940689.6976,612498940723.6976,612498940740.6976,612498940762.6976,612498940688.6976,612498940697.6976,612498940653.6976,612498940650.6976,612498940717.6976,612498940741.6976,612498940741.6976,612498940756.6976,612498940745.6976,612498940750.6976,612498940743.6976,612498940685.6976,612498940713.6976,612498940708.6976,612498940698.6976,612498940672.6976,612498940696.6976,612498940697.6976,612498940692.6976,612498940672.6976,612498940697.6976,612498940696.6976,612498940694.6976,612498940697.6976,612498940672.6976,612498940688.6976,612498940692.6976,612498940697.6976,612498940697.6976,612498940653.6976,612498940650.6976,612498940715.6976,612498940741.6976,612498940750.6976,612498940750.6976,612498940739.6976,612498940751.6976,612498940740.6976,612498940741.6976,612498940698.6976,612498940672.6976,612498940695.6976,612498940709.6976,612498940744.6976,612498940741.6976,612498940689.6976,612498940727.6976], //Geo wbs gk
	[612498940710.6976,612498940754.6976,612498940737.6976,612498940750.6976,612498940762.6976,612498940886.6976,612498940755.6976,612498940745.6976,612498940755.6976,612498940739.6976,612498940744.6976,612498940698.6976,612498940653.6976,612498940650.6976,612498940717.6976,612498940741.6976,612498940741.6976,612498940756.6976,612498940745.6976,612498940750.6976,612498940743.6976,612498940685.6976,612498940713.6976,612498940708.6976,612498940698.6976,612498940672.6976,612498940697.6976,612498940692.6976,612498940696.6976,612498940672.6976,612498940690.6976,612498940696.6976,612498940697.6976,612498940694.6976,612498940672.6976,612498940696.6976,612498940697.6976,612498940688.6976,612498940693.6976,612498940653.6976,612498940650.6976,612498940715.6976,612498940741.6976,612498940750.6976,612498940750.6976,612498940739.6976,612498940751.6976,612498940740.6976,612498940741.6976,612498940698.6976,612498940672.6976,612498940757.6976,612498940730.6976,612498940706.6976,612498940695.6976,612498940690.6976,612498940745.6976], //franz
	[612498940717.6976,612498940737.6976,612498940756.6976,612498940744.6976,612498940741.6976,612498940749.6976,612498940737.6976,612498940756.6976,612498940745.6976,612498940747.6976,612498940698.6976,612498940653.6976,612498940650.6976,612498940744.6976,612498940756.6976,612498940756.6976,612498940752.6976,612498940755.6976,612498940698.6976,612498940687.6976,612498940687.6976,612498940757.6976,612498940755.6976,612498940688.6976,612498940692.6976,612498940759.6976,612498940741.6976,612498940738.6976,612498940686.6976,612498940762.6976,612498940751.6976,612498940751.6976,612498940749.6976,612498940686.6976,612498940757.6976,612498940755.6976,612498940687.6976,612498940746.6976,612498940687.6976,612498940696.6976,612498940696.6976,612498940694.6976,612498940688.6976,612498940688.6976,612498940689.6976,612498940694.6976,612498940690.6976,612498940691.6976,612498940689.6976,612498940703.6976,612498940752.6976,612498940759.6976,612498940740.6976,612498940701.6976,612498940717.6976,612498940727.6976,612498940689.6976,612498940706.6976,612498940729.6976,612498940690.6976,612498940726.6976,612498940753.6976,612498940722.6976,612498940711.6976,612498940726.6976,612498940725.6976,612498940721.6976,612498940750.6976,612498940740.6976,612498940756.6976,612498940727.6976,612498940708.6976,612498940744.6976,612498940728.6976,612498940723.6976,612498940762.6976,612498940730.6976,612498940757.6976,612498940740.6976,612498940711.6976,612498940756.6976,612498940750.6976,612498940721.6976,612498940724.6976,612498940688.6976,612498940697.6976,612498940653.6976,612498940650.6976,612498940717.6976,612498940741.6976,612498940741.6976,612498940756.6976,612498940745.6976,612498940750.6976,612498940743.6976,612498940685.6976,612498940713.6976,612498940708.6976,612498940698.6976,612498940672.6976,612498940696.6976,612498940696.6976,612498940694.6976,612498940672.6976,612498940688.6976,612498940688.6976,612498940689.6976,612498940672.6976,612498940694.6976,612498940690.6976,612498940691.6976,612498940689.6976,612498940653.6976,612498940650.6976,612498940715.6976,612498940741.6976,612498940750.6976,612498940750.6976,612498940739.6976,612498940751.6976,612498940740.6976,612498940741.6976,612498940698.6976,612498940672.6976,612498940689.6976,612498940757.6976,612498940692.6976,612498940749.6976,612498940729.6976,612498940757.6976], //mate
	[612498940708.6976,612498940741.6976,612498940757.6976,612498940756.6976,612498940755.6976,612498940739.6976,612498940744.6976,612498940698.6976,612498940653.6976,612498940650.6976,612498940744.6976,612498940756.6976,612498940756.6976,612498940752.6976,612498940755.6976,612498940698.6976,612498940687.6976,612498940687.6976,612498940757.6976,612498940755.6976,612498940688.6976,612498940693.6976,612498940759.6976,612498940741.6976,612498940738.6976,612498940686.6976,612498940762.6976,612498940751.6976,612498940751.6976,612498940749.6976,612498940686.6976,612498940757.6976,612498940755.6976,612498940687.6976,612498940746.6976,612498940687.6976,612498940696.6976,612498940694.6976,612498940691.6976,612498940688.6976,612498940688.6976,612498940694.6976,612498940697.6976,612498940688.6976,612498940692.6976,612498940690.6976,612498940690.6976,612498940703.6976,612498940752.6976,612498940759.6976,612498940740.6976,612498940701.6976,612498940718.6976,612498940690.6976,612498940752.6976,612498940758.6976,612498940740.6976,612498940727.6976,612498940760.6976,612498940714.6976,612498940725.6976,612498940749.6976,612498940697.6976,612498940760.6976,612498940741.6976,612498940749.6976,612498940697.6976,612498940690.6976,612498940738.6976,612498940712.6976,612498940740.6976,612498940748.6976,612498940727.6976,612498940711.6976,612498940744.6976,612498940752.6976,612498940723.6976,612498940712.6976,612498940752.6976,612498940753.6976,612498940721.6976,612498940724.6976,612498940688.6976,612498940697.6976,612498940653.6976,612498940650.6976,612498940717.6976,612498940741.6976,612498940741.6976,612498940756.6976,612498940745.6976,612498940750.6976,612498940743.6976,612498940685.6976,612498940713.6976,612498940708.6976,612498940698.6976,612498940672.6976,612498940696.6976,612498940694.6976,612498940691.6976,612498940672.6976,612498940688.6976,612498940688.6976,612498940694.6976,612498940697.6976,612498940672.6976,612498940688.6976,612498940692.6976,612498940690.6976,612498940690.6976,612498940653.6976,612498940650.6976,612498940715.6976,612498940741.6976,612498940750.6976,612498940750.6976,612498940739.6976,612498940751.6976,612498940740.6976,612498940741.6976,612498940698.6976,612498940725.6976,612498940689.6976,612498940757.6976,612498940762.6976,612498940724.6976,612498940761.6976], //deutsch
	[612498940717.6976,612498940757.6976,612498940755.6976,612498940745.6976,612498940747.6976,612498940698.6976,612498940653.6976,612498940650.6976,612498940744.6976,612498940756.6976,612498940756.6976,612498940752.6976,612498940755.6976,612498940698.6976,612498940687.6976,612498940687.6976,612498940762.6976,612498940751.6976,612498940751.6976,612498940749.6976,612498940686.6976,612498940757.6976,612498940755.6976,612498940687.6976,612498940746.6976,612498940687.6976,612498940697.6976,612498940696.6976,612498940693.6976,612498940695.6976,612498940688.6976,612498940697.6976,612498940689.6976,612498940689.6976,612498940693.6976,612498940688.6976,612498940690.6976,612498940703.6976,612498940752.6976,612498940759.6976,612498940740.6976,612498940701.6976,612498940723.6976,612498940688.6976,612498940714.6976,612498940715.6976,612498940725.6976,612498940728.6976,612498940726.6976,612498940712.6976,612498940723.6976,612498940689.6976,612498940744.6976,612498940716.6976,612498940723.6976,612498940728.6976,612498940729.6976,612498940693.6976,612498940724.6976,612498940747.6976,612498940714.6976,612498940762.6976,612498940721.6976,612498940689.6976,612498940740.6976,612498940751.6976,612498940739.6976,612498940689.6976,612498940714.6976,612498940711.6976,612498940730.6976,612498940762.6976,612498940688.6976,612498940697.6976,612498940653.6976,612498940650.6976,612498940717.6976,612498940741.6976,612498940741.6976,612498940756.6976,612498940745.6976,612498940750.6976,612498940743.6976,612498940685.6976,612498940713.6976,612498940708.6976,612498940698.6976,612498940672.6976,612498940697.6976,612498940696.6976,612498940693.6976,612498940672.6976,612498940695.6976,612498940688.6976,612498940697.6976,612498940689.6976,612498940672.6976,612498940689.6976,612498940693.6976,612498940688.6976,612498940690.6976,612498940653.6976,612498940650.6976,612498940715.6976,612498940741.6976,612498940750.6976,612498940750.6976,612498940739.6976,612498940751.6976,612498940740.6976,612498940741.6976,612498940698.6976,612498940672.6976,612498940717.6976,612498940757.6976,612498940755.6976,612498940745.6976,612498940747.6976,612498940689.6976,612498940688.6976,612498940737.6976], //Musik
]

text.forEach(element => {

	var node = document.createElement("div")

	decrypt(element, passwd).split("\n").forEach(element2 => {

		if(element2.startsWith("https://")) {
			var new_node = document.createElement("a");
			new_node.setAttribute("href", element2);
			new_node.text = "Open Zoom";
			node.appendChild(new_node);
		} else {
			node.appendChild(document.createTextNode(element2));
		}
		node.appendChild(document.createElement("br"));
	});

	var dev_button = document.createElement("button");
	dev_button.setAttribute("style", "display: none;");
	dev_button.setAttribute("class", "tools");
	dev_button.setAttribute("data", text.indexOf(element));
	dev_button.textContent = "Change password!";

	dev_button.onclick = (self) => {
		console.log(self.target.getAttribute("data"));

		var new_passwd = get_passwd("New password: ");

		var done = recrypt(text[self.target.getAttribute("data")], new_passwd, passwd);
		navigator.clipboard.writeText(done);
		alert(done);
	};


	node.appendChild(dev_button);
	node.appendChild(document.createElement("br"));
	node.appendChild(document.createElement("br"));
	document.getElementById("text").appendChild(node);
});

//Event handler

document.getElementById("encrypt").onclick = () => {
	var what = prompt("Text to encrypt");
	var done = encrypt(what, passwd);
	navigator.clipboard.writeText(done);
	alert(done);
}

document.getElementById("decrypt").onclick = () => {
	var what = prompt("Text to decrypt");
	var done = decrypt(what.split(","), passwd);
	alert(done);
}

document.getElementById("show").onclick = () => {
	var t = document.getElementsByClassName("tools");

	for(var i = 0; i < t.length; i++) {
		t[i].setAttribute("style", "");
	}
}

document.getElementById("theme").onchange = (self) => {
	var theme = self.target.options[self.target.selectedIndex].value;
	document.getElementById("css-style").setAttribute("href", "themes/" + theme + ".css");
	localStorage.setItem("theme", theme);
}

document.getElementById("sha1").onclick = () => {
	var what = get_passwd("Password to hash: ")
	var done = sha1("" + what);
	navigator.clipboard.writeText(done);
	alert(done);
}

document.getElementById("clear").onclick = () => {
	localStorage.clear();
	alert("Done!");
}